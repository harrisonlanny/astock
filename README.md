复权：前降后升

TODOLIST:
- 20230519
  - 写db工具函数 update_table_fields: 修改表结构
  - 写service函数 ：update_d_tables: 遍历数据库d表，检查表如果空，则请求api接口填充该表；如果非空，拿最新的数据日期,最后对齐请求结束
  
d_000536表为空，调用fetch_daily(000536.SZ) 143/5383
query daily from  to 
6000
query daily from 19940810 to 19940810
1
end_date 19940809
query daily from  to 19940809
169
api返回字段排序后： ['ts_code', 'trade_date', 'open', 'high', 'low', 'close', 'pre_close', 'change', 'pct_chg', 'vol', 'amount', 'adj_factor']
DELETE FROM d_000536


d_001324表为空，调用fetch_daily(001324.SZ) 566/5383
query daily from  to 
0
fields: ['ts_code' 'trade_date' 'open' 'high' 'low' 'close' 'pre_close' 'change'
 'pct_chg' 'vol' 'amount' 'adj_factor']
DELETE FROM d_001324
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1")


天齐锂业 预计涨到96，第一波涨到88.7

巨潮资讯网(看财报)
http://www.cninfo.com.cn/new/commonUrl/pageOfSearch?url=disclosure/list/search&lastPage=index
## 快速筛选标准无保留意见的财报
文本包含“公允反映了”或“标准无保留意见”，若不符合条件，直接跳过
## 快速阅读资产负债表
### 钱的来源
1.财报最后一行“负债和所有者权益合计”-有多少家当
2.财报倒数第二行“所有者权益合计”-有多少是自己的
3.1、2相减-负债
4.看负债项目，找出有疑虑的项目。例如：为何有钱却欠着税款不交？-搜索“应交税费”
5.找出应交税费明细
6.计算企业负债率：有息负债/总资产，与同时期、同行业的公司比较
7.有息负债/总资产>=60%，应小心
8.一般情况下，“短期借款”、“长期借款”、“应付债券”、“一年内到期的非流动性负债”、“一年内到期的融资租赁负债”、“长期融资租赁负债”都是有息负债
### 钱的去处
1.资产总计，对与上一期财报的增长有个大概印象
2.四个要点：生产资产/总资产（评价公司类型：重公司/轻公司）、应收/总资产、货币资金/有息负债、非主业资产/总资产；三个角度：结构、历史、同行
3.生产资产/总资产
结构：
  当年税前利润总额/生产资产（生产资产：固定资产+在建工程+工程物资+无形资产里的土地），得出的比值显著高于社会平均资本回报率【银行贷款标准利率的两倍】，轻资产>重资产；
历史、同行：
  看生产资产/总资产如何变化，竞争对手如何变化，若一致则未发生转折，否则蕴藏机会或陷阱。思考变化的原因；
4.应收/总资产
应收 = 资产负债表所有带“应收”两个字的科目数字总和-银行承兑汇票金额
1）应收/总资产，不应大于30%；(完成)
2）应收账款余额/月均营业收入，越小越好（与同行业公司比较，处于中位数以下）；
3）除基数较小的情况，不应发生超过营业收入增幅的应收款增幅；
4）观察异常：某些应收款单独测试减值为0，应收款集中在少数关联企业，其他应收款科目突然大幅增加
5.货币资金/有息负债（偿债能力）
有息负债：融资性负债（短期借款、交易性金融负债、长期借款、应付债券、一年内到期的非流动负债等）一般都是有息负债，而经营性负债和分配性负债则不是
货币资金>=有息负债
可放宽：货币资金+随时可变现的交易性金融资产、应收票据>=有息负债
可纵向比较：看看企业历史发生的变化
6.非主业资产/总资产
非主业资产：如制造业企业的交易性金融资产、可供出售金融资产、持有至到期投资、银行理财产品或投资性房地产（与主业经营无关的资产）
比例增加，说明公司管理层认为在自己的行业内已经很难发现有潜力的投资机会

## 快速阅读利润表
1.营业收入
潜在需求、市场份额、价格（三种增长途径，潜在需求的可靠性最强）；
保持增长（营业利润增长率、营业收入绝对增长、增速高于行业平均水平）；
对细分市场规模有限，容不下更多对手的企业：关注经营所得现金去向和利用效率
2.毛利率
高毛利率意味着公司的产品或服务具有很强的竞争优势，尽量选择高毛利率公司（>=40%）
3.费用率
1）三费：销售费用、管理费用、财务费用；
2）保守策略-单独考虑财务费用
如果利润表财务费用>0:
    费用 = 销售费用+管理费用+财务费用
如果利润表财务费用<0:
    费用 = 销售费用+管理费用
3）管理费用增幅<=营业收入增幅
4）费用/毛利润<30%:优秀，30%<费用/毛利润<70%：有竞争力
4.营业利润率
营业利润率 = 营业利润/营业收入（越高越好。看数字大小、对比历史变化，看主要是因为售价提升、成本下降还是费用控制得力）
5.确认净利润是否变成现金回到公司账户
经营现金流净额/净利润持续大于1，比值越大越好（【全国地产】企业除外）

## 快速阅读现金流量表
1.经营活动产生的现金流量净额>净利润>0
2.销售商品、提供劳务收到的现金>=营业收入
3.投资活动现金流出>投资活动现金流入，且主要是用于扩张，而非用于维持原有盈利能力
4.现金及现金等价物净增加额>0，可放宽：排除当年实施的现金分红因素影响后，现金及现金等价物净增加额>0
5.期末现金及现金等价物余额>=有息负债，可放宽：期末现金及现金等价物+可迅速变现的金融资产净值>有息负债
6.需要数年持续如上或累计如上


## 财务指标分析
#### 安全性分析
现金债务比=现金及现金等价物/有息负债>1
放宽为：
（现金及现金等价物+可迅速变现但金融资产净值）/有息负债>=1
（现金及现金等价物+可迅速变现但金融资产净值）/一年内到期的有息负债>=1
#### 盈利能力分析
净资产收益率（ROE）=净利润/平均净资产
总资产收益率（ROA）=净利润/平均总资产
首选ROE指标，去发现高经济商誉的企业（越高越好）；
相同ROE情况下，更高的ROA代表更强的盈利能力和更小的风险（杠杆更小）
#### 成长性分析
营业收入增长率=（本期营业收入-上期营业收入）/上期营业收入
营业利润增长率=（本期营业利润-上期营业利润）/上期营业利润
资产增长率=（本期资产-上期资产）/上期资产
净资产增长率=（本期净资产-上期净资产）/上期净资产
#### 管理层能力分析
1.应收账款周转率
应收账款周转率=营业收入/平均应收账款
平均应收账款=（期初应收账款总额+期末应收账款总额）/2
营业收入的增长，伴随着应收账款周转率的稳定或提高，意味着营业收入的增长是可靠的、值得信赖的
2.存货周转率
存货周转率=营业成本/存货平均余额
存货平均余额=（期初存货总额+期末存货总额）/2
根据企业情况，以满足市场需求的情况下，保持最小库存为至高境界
3.固定资产周转率
固定资产周转率=营业收入/固定资产净值
反映企业属于轻资产还是重资产
4.总资产周转率
总资产周转率=营业收入/平均总资产
越大，反映企业管理层资产运用能力越强
#### 总体分析
净资产收益率
=净利润/净资产
=（净利润/销售收入）*（销售收入/平均总资产）*（平均总资产/净资产）
=产品净利润率*总资产周转率*杠杆系数
分别对应高净利率（茅台模式）、高管理层运营能力（沃尔玛模式）、高杠杆（银行模式）


SELECT * FROM  announcements a where title like '%2005%' and title not like '%英文%'  and title not like '%（已取消）%' and title not like '%摘要%'

今天任务
1. 表格解析，隐藏线去掉后，有些pdf解析不出表格
2. 下载pdf，相当多pdf格式错误
3. 下载pdf优化，只下载不含英文 且 不含简要 且 不含取消 的年度报表